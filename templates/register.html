{% extends 'index.html' %}
{% block content %}
<div class="d-grid">
    <form action="/register" method="post" class="row g-3 needs-validation" novalidate>
        <div class="col-md-4">
            <label for="firstName" class="form-label">First Name</label>
            <input type="text" class="form-control" name="firstName" id="firstName" placeholder="First" oninput="updateAssetName()" required>
            <div class="valid-feedback">
                Looks good!
            </div>
            <div class="invalid-feedback">
                Please enter your first name.
            </div>
        </div>
        <div class="col-md-4">
            <label for="lastName" class="form-label">Last Name</label>
            <input type="text" class="form-control" name="lastName" id="lastName" placeholder="Last" required>
            <div class="valid-feedback">
                Looks good!
            </div>
            <div class="invalid-feedback">
                Please enter your last name.
            </div>
        </div>
        <div class="col-md-4">
            <label for="email" class="form-label">Email Address</label>
            <input type="email" class="form-control" name="email" id="email" placeholder="Email" required>
            <div class="valid-feedback">
                Looks good!
            </div>
            <div class="invalid-feedback">
                Please enter a valid email address.
            </div>
        </div>
        <div class="col-md-4">
            <label for="phoneNumber" class="form-label">Phone Number</label>
            <input type="tel" class="form-control" name="phoneNumber" id="phoneNumber" placeholder="Phone #" pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}" required>
            <div class="valid-feedback">
                Looks good!
            </div>
            <div class="invalid-feedback">
                Please enter a valid phone number.
            </div>
        </div>
        <div class="col-md-4">
            <label for="assetName" class="form-label">Asset Name</label>
            <input type="text" class="form-control" name="assetName" id="assetName" placeholder="Asset Name" oninput="disableAutoUpdate(event)">
            <div class="valid-feedback">
                Looks good!
            </div>
            <div class="invalid-feedback">
                Please enter a valid asset name.
            </div>
        </div>
        <div class="col-md-4">
            <label for="imei" class="form-label">IMEI Number</label>
            {% if imei %}
                <input type="number" class="form-control" name="imei" id="imei" placeholder="IMEI #" value="{{ imei }}" required>
            {% else %}
                <input type="number" class="form-control" name="imei" id="imei" placeholder="IMEI #" required>
            {% endif %}
            <div class="valid-feedback">
                Looks good!
            </div>
            <div class="invalid-feedback">
                Please enter a valid IMEI number.
            </div>
        </div>
        <div id="optionalFields" class="d-none">
            <div class="col-md-4">
                <label for="vin" class="form-label">VIN Number</label>
                <input type="text" class="form-control" name="vin" id="vin" placeholder="Vin #">
            </div>
        </div>
        <div class="col-md-4">
            <button type="submit" class="btn btn-primary" id="register">Register</button>
            <button type="button" class="btn btn-secondary" id="toggle" onclick="toggleOptionalFields()">Show Options</button>
        </div>
    </form>
</div>
<script>
  const defaultFormat = "'s Ride"
  let autoUpdateEnabled = true;
  let toggleButton = document.getElementById('toggle');
  function updateAssetName() {
    let firstNameValue = document.getElementById('firstName').value;

    if (autoUpdateEnabled) {
      document.getElementById('assetName').value = firstNameValue + defaultFormat;
    }
  }

  function disableAutoUpdate(event) {
      if (event.isTrusted) { autoUpdateEnabled = false; }
  }

  function toggleOptionalFields() {
    let optionalFields = document.getElementById('optionalFields');
      if (optionalFields.classList.contains('d-none')) {
        toggleButton.innerText = 'Hide Options';
        optionalFields.classList.toggle('d-none');
    } else {
        toggleButton.innerText = 'Show Options';
        optionalFields.classList.toggle('d-none');
    }
  }

</script>
{% endblock %}
